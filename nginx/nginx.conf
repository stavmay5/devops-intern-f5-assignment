# Nginx Configuration

events {}

http {
    # Rate limiting: 5 requests/sec per IP. Trade-off: users behind NAT share limit
    limit_req_zone $binary_remote_addr zone=mylimit:10m rate=5r/s;

    # Server 1: Main web server (port 8080)
    server {
        listen 8080;

        # burst=5 allows short traffic spikes. nodelay = don't queue, block immediately
        limit_req zone=mylimit burst=5 nodelay;

        location / {
            root /var/www/html;
            index index.html;
        }
    }

    # Server 2: Error simulation. Design choice: separate port instead of /error path
    server {
        listen 8081;
        location / {
            # Always returns 500 - simulates server failure for testing
            return 500 "Simulation of Internal Server Error";
        }
    }
}
